<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Klodev Apex | Secure Login</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@300;400;500;600;700&display=swap');

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        /* LIGHT THEME BACKGROUND */
        body {
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            background: linear-gradient(135deg, #e0e7ff 0%, #f1f5f9 100%);
            font-family: 'Space Grotesk', sans-serif;
            padding: 1rem;
            position: relative;
            overflow: hidden;
            animation: fadeInPage 0.8s ease-out; /* Smooth transition from landing page */
        }

        @keyframes fadeInPage {
            0% { opacity: 0; }
            100% { opacity: 1; }
        }

        /* Atmospheric glowing orbs (Light Blue) */
        .glow-orbit {
            position: absolute;
            width: 700px;
            height: 700px;
            background: radial-gradient(circle at 40% 50%, rgba(59, 130, 246, 0.15), transparent 60%);
            border-radius: 50%;
            top: -200px;
            right: -200px;
            filter: blur(70px);
            z-index: 0;
        }
        
        .glow-orbit-2 {
            position: absolute;
            width: 600px;
            height: 600px;
            background: radial-gradient(circle at 60% 40%, rgba(99, 102, 241, 0.1), transparent 70%);
            border-radius: 50%;
            bottom: -250px;
            left: -150px;
            filter: blur(80px);
            z-index: 0;
        }

        /* Main Login Glass Card - BRIGHT AND CLEAN */
        .login-card {
            background: rgba(255, 255, 255, 0.9);
            backdrop-filter: blur(20px) saturate(150%);
            -webkit-backdrop-filter: blur(20px) saturate(150%);
            border: 1px solid rgba(255, 255, 255, 0.8);
            border-radius: 24px;
            padding: 60px 45px 40px; 
            width: 420px; 
            position: relative;
            z-index: 10;
            box-shadow: 0 25px 50px -12px rgba(15, 23, 42, 0.1), 0 0 0 1px rgba(226, 232, 240, 0.5) inset;
            animation: slideUpCard 0.6s cubic-bezier(0.16, 1, 0.3, 1) forwards;
            opacity: 0;
            transform: translateY(30px);
        }

        @keyframes slideUpCard {
            to { opacity: 1; transform: translateY(0); }
        }

        /* DROID MASCOT CONTAINER */
        .mascot-container {
            position: absolute;
            top: -85px; 
            left: 50%;
            transform: translateX(-50%);
            width: 160px; 
            height: 160px; 
            background: transparent;
            z-index: 30;
            filter: drop-shadow(0 15px 20px rgba(15, 23, 42, 0.15));
        }

        .droid-svg {
            width: 100%;
            height: 100%;
            display: block;
            overflow: visible;
        }

        .title {
            text-align: center;
            color: #0f172a;
            font-size: 1.8rem; 
            font-weight: 700;
            letter-spacing: -0.02em;
            margin-bottom: 25px;
        }
        
        .title span {
            display: block;
            font-size: 0.85rem; 
            font-weight: 600;
            color: #64748b;
            letter-spacing: 2px;
            text-transform: uppercase;
            margin-top: 6px;
        }

        /* Input Layout */
        .input-group {
            position: relative;
            margin-bottom: 24px; 
        }

        .input-group label {
            display: block;
            font-size: 0.8rem;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 1px;
            color: #475569;
            margin-bottom: 8px;
            margin-left: 4px;
        }

        .input-field {
            width: 100%;
            padding: 14px 20px; 
            background: #f8fafc;
            border: 2px solid #e2e8f0;
            border-radius: 12px;
            font-size: 1rem;
            color: #0f172a;
            font-family: inherit;
            font-weight: 500;
            transition: all 0.2s ease;
        }

        .input-field:focus {
            outline: none;
            border-color: #3b82f6;
            background: #ffffff;
            box-shadow: 0 4px 15px rgba(59, 130, 246, 0.15), 0 0 0 3px rgba(59, 130, 246, 0.2);
        }

        .input-field::placeholder {
            color: #94a3b8;
            font-weight: 400;
        }

        /* Show/Hide Password Toggle */
        .show-pwd {
            position: absolute;
            right: 15px;
            top: 40px; 
            font-size: 0.8rem;
            font-weight: 700;
            color: #3b82f6;
            cursor: pointer;
            transition: 0.2s;
            user-select: none;
        }

        .show-pwd:hover {
            color: #2563eb;
        }

        /* Submit Button */
        .btn-submit {
            width: 100%;
            padding: 16px; 
            background: linear-gradient(135deg, #2563eb, #1d4ed8);
            color: white;
            border: none;
            border-radius: 12px;
            font-size: 1.1rem; 
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s;
            margin-top: 10px;
            box-shadow: 0 10px 20px -5px rgba(37, 99, 235, 0.4);
            letter-spacing: 0.5px;
        }

        .btn-submit:hover {
            transform: translateY(-2px);
            box-shadow: 0 15px 25px -5px rgba(37, 99, 235, 0.5);
        }

        /* Bottom Link */
        .link-text {
            display: block;
            text-align: center;
            margin-top: 24px;
            font-size: 0.95rem;
            color: #64748b;
            text-decoration: none;
            font-weight: 600;
            transition: 0.2s;
        }
        
        .link-text:hover {
            color: #3b82f6;
        }

        /* Alerts for backend messages */
        .alert {
            background: #fee2e2;
            color: #ef4444;
            padding: 12px 16px;
            border-radius: 8px;
            text-align: center;
            font-size: 0.9rem;
            font-weight: 600;
            margin-bottom: 20px;
            border: 1px solid #fca5a5;
        }
        
        .alert-success {
            background: #d1fae5;
            color: #059669;
            border-color: #6ee7b7;
        }

        @media (max-width: 480px) {
            .login-card { width: 100%; padding: 50px 25px 30px; }
        }
    </style>
</head>
<body>
    <div class="glow-orbit"></div>
    <div class="glow-orbit-2"></div>

    <div class="login-card">
        <div class="mascot-container">
            <svg class="droid-svg" viewBox="0 0 200 200" fill="none" xmlns="http://www.w3.org/2000/svg">
                <defs>
                    <linearGradient id="droidMetal" x1="0%" y1="0%" x2="100%" y2="100%">
                        <stop offset="0%" stop-color="#ffffff" />
                        <stop offset="50%" stop-color="#f1f5f9" />
                        <stop offset="100%" stop-color="#cbd5e1" />
                    </linearGradient>
                    <linearGradient id="visorGrad" x1="50%" y1="0%" x2="50%" y2="100%">
                        <stop offset="0%" stop-color="#020617" />
                        <stop offset="100%" stop-color="#0f172a" />
                    </linearGradient>
                    <linearGradient id="shutterGrad" x1="0%" y1="0%" x2="0%" y2="100%">
                        <stop offset="0%" stop-color="#ffffff" />
                        <stop offset="100%" stop-color="#e2e8f0" />
                    </linearGradient>
                    <filter id="sensorGlow" x="-50%" y="-50%" width="200%" height="200%">
                        <feGaussianBlur stdDeviation="4" result="coloredBlur" />
                        <feMerge>
                            <feMergeNode in="coloredBlur" />
                            <feMergeNode in="SourceGraphic" />
                        </feMerge>
                    </filter>
                </defs>

                <g transform="translate(100 100)">
                    <path d="M-70 -20 C-70 -70 70 -70 70 -20 L 60 60 C 60 90 -60 90 -60 60 Z" fill="url(#droidMetal)" stroke="#94a3b8" stroke-width="2"/>
                    <rect x="-85" y="-10" width="15" height="40" rx="5" fill="url(#droidMetal)" stroke="#cbd5e1"/>
                    <rect x="70" y="-10" width="15" height="40" rx="5" fill="url(#droidMetal)" stroke="#cbd5e1"/>

                    <path d="M-55 0 C-55 -25 55 -25 55 0 L 50 45 C 50 60 -50 60 -50 45 Z" fill="url(#visorGrad)" stroke="#cbd5e1" stroke-width="1"/>

                    <g id="pupils" style="transition: transform 0.1s ease-out;">
                        <circle cx="-25" cy="25" r="10" fill="#3b82f6" filter="url(#sensorGlow)"/>
                        <circle cx="-25" cy="25" r="5" fill="#ffffff"/>
                        <circle cx="25" cy="25" r="10" fill="#3b82f6" filter="url(#sensorGlow)"/>
                        <circle cx="25" cy="25" r="5" fill="#ffffff"/>
                    </g>

                    <path d="M-50 5 C-30 5 -10 15 -5 30" stroke="rgba(255,255,255,0.2)" stroke-width="3" fill="none" stroke-linecap="round"/>

                    <g id="shutter-top" style="transform: translateY(-20px); transition: transform 0.4s cubic-bezier(0.4, 0.0, 0.2, 1);">
                         <path d="M-58 -5 C-58 -30 58 -30 58 -5 L 58 15 L -58 15 Z" fill="url(#shutterGrad)" stroke="#94a3b8" stroke-width="1.5"/>
                         <line x1="-50" y1="5" x2="50" y2="5" stroke="#cbd5e1" stroke-width="2"/>
                    </g>
                    
                    <g id="shutter-bottom" style="transform: translateY(20px); transition: transform 0.4s cubic-bezier(0.4, 0.0, 0.2, 1);">
                        <path d="M-58 65 L 58 65 L 58 45 C 58 70 -58 70 -58 45 Z" fill="url(#shutterGrad)" stroke="#94a3b8" stroke-width="1.5"/>
                        <line x1="-50" y1="55" x2="50" y2="55" stroke="#cbd5e1" stroke-width="2"/>
                    </g>
                </g>
            </svg>
        </div>

        <div class="title">Klodev Apex <span>Secure Login</span></div>

        {% if error %} 
            <div class="alert"><i class="fas fa-exclamation-circle"></i> {{ error }}</div> 
        {% endif %}
        
        {% if request.args.get('registered') %} 
            <div class="alert alert-success"><i class="fas fa-check-circle"></i> Account created successfully. Please log in.</div> 
        {% endif %}

        <form action="{{ url_for('login') }}" method="POST">
            <div class="input-group">
                <label>Username</label>
                <input type="text" id="username" name="username" class="input-field" placeholder="Enter your username" autocomplete="off" required>
            </div>
            
            <div class="input-group">
                <label>Password</label>
                <input type="password" id="password" name="password" class="input-field" placeholder="••••••••••" required>
                <div class="show-pwd" id="showPwdToggle">Show</div>
            </div>
            
            <button type="submit" class="btn-submit">Sign In</button>
        </form>

        <a href="{{ url_for('register') }}" class="link-text">Don't have an account? Sign up here.</a>
        
        <div style="text-align: center; font-size: 0.8rem; color: #94a3b8; margin-top: 25px;">
            Demo Credentials: admin / admin123
        </div>
    </div>

    <script>
        (function() {
            const username = document.getElementById('username');
            const password = document.getElementById('password');
            const showToggle = document.getElementById('showPwdToggle');

            const pupils = document.getElementById('pupils');
            const shutterTop = document.getElementById('shutter-top');
            const shutterBottom = document.getElementById('shutter-bottom');

            let isPasswordShown = false;

            const setShuttersOpen = () => {
                shutterTop.style.transform = 'translateY(-15px)';
                shutterBottom.style.transform = 'translateY(15px)';
            };

            const setShuttersClosed = () => {
                shutterTop.style.transform = 'translateY(16px)'; 
                shutterBottom.style.transform = 'translateY(-16px)';
            };

            const setShuttersPeek = () => {
                shutterTop.style.transform = 'translateY(-5px)';
                shutterBottom.style.transform = 'translateY(0px)';
            };

            // Initial state
            setShuttersOpen();
            pupils.style.transform = 'translate(0px, 0px)';

            // Username tracking
            username.addEventListener('focus', () => {
                if (!isPasswordShown) setShuttersOpen();
            });

            username.addEventListener('input', (e) => {
                let len = e.target.value.length;
                if (len > 24) len = 24;
                let moveX = (len / 24) * 16 - 8; 
                pupils.style.transform = `translate(${moveX}px, 0px)`;
            });

            username.addEventListener('blur', () => {
                if (document.activeElement !== password && !isPasswordShown) {
                    pupils.style.transform = `translate(0px, 0px)`;
                }
            });

            // Password focus closes shutters
            password.addEventListener('focus', () => {
                if (!isPasswordShown) {
                    setShuttersClosed();
                    pupils.style.transform = 'translate(0px, 0px)'; 
                }
            });

            password.addEventListener('blur', () => {
                if (!isPasswordShown) {
                    setShuttersOpen();
                }
            });

            // Show password peeks the shutters
            showToggle.addEventListener('click', () => {
                isPasswordShown = !isPasswordShown;

                if (isPasswordShown) {
                    password.type = 'text';
                    showToggle.textContent = 'Hide';
                    setShuttersPeek();
                    pupils.style.transform = 'translate(0px, -5px)';
                } else {
                    password.type = 'password';
                    showToggle.textContent = 'Show';
                    if (document.activeElement === password) {
                         setShuttersClosed();
                         pupils.style.transform = 'translate(0px, 0px)';
                    } else {
                        setShuttersOpen();
                    }
                }
            });

             document.addEventListener('click', (e) => {
                if (!username.contains(e.target) && !password.contains(e.target) && !showToggle.contains(e.target)) {
                    if (!isPasswordShown) {
                         setShuttersOpen();
                         pupils.style.transform = 'translate(0px, 0px)';
                    }
                }
            });
        })();
    </script>
</body>
</html>